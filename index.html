<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <button onclick="fff()">点击触发</button>
  <h3>测试：</h3>
</body>
<script>
  const h3 = document.querySelector('h3')
  const fff = () => {
    const textDecoder = new TextDecoder();
    fetch('http://127.0.0.1:3002').then(res => {
      const reader = res.body.getReader()
      new ReadableStream({
        start(controller) {
          async function push() {
            const { done, value } = await reader.read()
            if (done) {
              controller.close();
              return;
            }
            // v1.0
            // h3.innerHTML += textDecoder.decode(value)
            // 模拟操作->替换
            const text = document.createTextNode(textDecoder.decode(value))
            h3.appendChild(text)
            push();
          }
          push();
        }
      });
    })
  }
</script>

</html>